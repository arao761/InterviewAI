# Development overrides for docker-compose.yml
# Use with: docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

version: '3.8'

services:
  backend:
    # Mount code for hot reload in development
    volumes:
      - ./backend:/app/backend
      - ./ai-engine:/app/ai-engine
      - ./backend/uploads:/app/uploads
      - ./backend/data:/app/data
      - ./backend/logs:/app/logs
    # Override command for development with auto-reload
    command: ["sh", "-c", "cd /app/backend && alembic upgrade head && uvicorn main:app --host 0.0.0.0 --port 8000 --reload"]
    environment:
      DEBUG: "true"
      ENVIRONMENT: development

  frontend:
    # For development, we'll use a different approach - run dev server outside Docker
    # Or use volume mounts for hot reload
    build:
      target: deps
    volumes:
      - ./frontend:/app
      - /app/node_modules
      - /app/.next
    command: ["pnpm", "dev"]
    environment:
      NODE_ENV: development
      NEXT_PUBLIC_API_URL: http://localhost:8000/api/v1
